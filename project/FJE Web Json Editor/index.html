<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>å…¨ç”»å¹…Â·JSONç¼–è¾‘å™¨</title>
  <style>
    /* å½»åº•æ¶ˆç­æ‰€æœ‰ç•™ç™½ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      width: 100vw;
      height: 100vh;
      overflow: hidden;  /* ç¦æ­¢æ»šåŠ¨æ¡å¯¼è‡´çš„åç§» */
      background-color: #1e1e1e;
    }
    body {
      display: flex;
      flex-direction: column;
      font-family: 'JetBrains Mono', 'Cascadia Code', 'Fira Code', monospace;
    }
    /* å·¥å…·æ¡ï¼šæç®€ï¼Œä¸å ç©ºé—´ */
    .toolbar {
      display: flex;
      gap: 1px;
      background-color: #252526;
      padding: 4px 8px;
      border-bottom: 1px solid #3e3e3e;
      flex-shrink: 0;
    }
    .toolbar button {
      background: #2d2d2d;
      border: none;
      color: #cccccc;
      padding: 6px 12px;
      font-size: 13px;
      cursor: pointer;
      border-radius: 4px;
      font-family: inherit;
    }
    .toolbar button:hover {
      background: #3e3e3e;
      color: white;
    }
    /* æ ¸å¿ƒï¼šç¼–è¾‘åŒºåå™¬æ‰€æœ‰å‰©ä½™é«˜åº¦ */
    .editor-container {
      flex: 1;
      display: flex;
      position: relative;
      min-height: 0;  /* flexé™åˆ¶æº¢å‡º */
    }
    /* çœŸæ­£çš„å…¨å±ç¼–è¾‘åŒºï¼Œæ²¡æœ‰ä»»ä½•padding/marginæµªè´¹ */
    #jsonEditor {
      width: 100%;
      height: 100%;
      background: #1e1e1e;
      color: #d4d4d4;
      border: none;
      outline: none;
      font-family: inherit;
      font-size: 15px;
      line-height: 1.5;
      resize: none;
      padding: 16px;  /* è¿™é‡ŒåŠ ä¸€ç‚¹å†…è¾¹è·æ˜¯ä¸ºäº†é˜…è¯»èˆ’é€‚ï¼Œå¦‚æœä½ æƒ³è¦å®Œå…¨é¡¶åˆ°å¤´ï¼Œæ”¹æˆ0 */
      tab-size: 2;
    }
    /* çŠ¶æ€æ ï¼šæç®€ï¼Œåªå ä¸€è¡Œ */
    .status-bar {
      background: #007acc;
      color: white;
      padding: 4px 12px;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      flex-shrink: 0;
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <button onclick="formatJSON()">âœ¨ æ ¼å¼åŒ–</button>
    <button onclick="compressJSON()">ğŸ—œï¸ å‹ç¼©</button>
    <button onclick="validateJSON()">âœ… æ ¡éªŒ</button>
    <span style="color:#888; margin-left:auto; font-size:12px; align-self:center;">å…¨å±Â·é›¶æµªè´¹</span>
  </div>

  <div class="editor-container">
    <textarea id="jsonEditor" spellcheck="false" placeholder="åœ¨è¿™é‡Œç²˜è´´æˆ–ç¼–è¾‘ JSON...">{
  "name": "å…¨ç”»å¹…ç¼–è¾‘å™¨",
  "purpose": "åå™¬æ¯ä¸€åƒç´ ",
  "screen": "100%",
  "example": ["æ— ç•™ç™½", "æ— ä¾§è¾¹æ ", "æ— å¹¿å‘Š"],
  "note": "F11 å…¨å±åï¼Œè¿™å°±æ˜¯IDE"
}</textarea>
  </div>

  <div class="status-bar">
    <span id="cursorPos">è¡Œ 1, åˆ— 1</span>
    <span id="jsonStatus">âœ… JSON æœ‰æ•ˆ</span>
  </div>

  <script>
    const editor = document.getElementById('jsonEditor');
    const cursorPos = document.getElementById('cursorPos');
    const jsonStatus = document.getElementById('jsonStatus');

    // å®æ—¶è¡Œå·/åˆ—å·
    editor.addEventListener('keyup', updateCursor);
    editor.addEventListener('click', updateCursor);
    editor.addEventListener('input', validateRealTime);

    function updateCursor() {
      const val = editor.value;
      const idx = editor.selectionStart;
      const lines = val.substring(0, idx).split('\n');
      const line = lines.length;
      const col = lines[lines.length-1].length + 1;
      cursorPos.textContent = `è¡Œ ${line}, åˆ— ${col}`;
    }

    // å®æ—¶æ ¡éªŒ
    function validateRealTime() {
      try {
        JSON.parse(editor.value);
        jsonStatus.innerHTML = 'âœ… JSON æœ‰æ•ˆ';
        jsonStatus.style.color = '#a0e0a0';
      } catch (e) {
        jsonStatus.innerHTML = `âŒ ${e.message}`;
        jsonStatus.style.color = '#ffa0a0';
      }
    }

    function formatJSON() {
      try {
        const json = JSON.parse(editor.value);
        editor.value = JSON.stringify(json, null, 2);
        validateRealTime();
      } catch (e) {
        alert('æ ¼å¼åŒ–å¤±è´¥ï¼š' + e.message);
      }
    }

    function compressJSON() {
      try {
        const json = JSON.parse(editor.value);
        editor.value = JSON.stringify(json);
        validateRealTime();
      } catch (e) {
        alert('å‹ç¼©å¤±è´¥ï¼š' + e.message);
      }
    }

    function validateJSON() {
      try {
        JSON.parse(editor.value);
        alert('âœ… JSON æ ¼å¼å®Œå…¨æ­£ç¡®');
      } catch (e) {
        alert('âŒ é”™è¯¯ï¼š' + e.message);
      }
    }

    // åˆå§‹åŒ–æ ¡éªŒ
    validateRealTime();
    updateCursor();
  </script>
</body>
</html>